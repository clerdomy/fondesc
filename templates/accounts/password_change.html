{% extends 'base.html' %}
{% load static %}

{% block title %}Change Password | Fondesc{% endblock %}

{% block content %}
<div class="container mx-auto py-12 px-4">
  <div class="flex flex-col lg:flex-row gap-8">
      <!-- Sidebar do perfil -->
      <div class="w-full lg:w-1/4">
          <div class="bg-white rounded-xl shadow-md overflow-hidden" data-aos="fade-right">
              <div class="p-6 text-center">
                  {% if user.profile_picture %}
                  <img src="{{ user.profile_picture.url }}" alt="{{ user.username }}" class="rounded-full w-32 h-32 object-cover mx-auto mb-4 border-4 border-gray-100 shadow">
                  {% else %}
                  <div class="bg-primary text-white rounded-full w-32 h-32 flex items-center justify-center mx-auto mb-4 text-4xl font-bold border-4 border-gray-100 shadow">
                      {{ user.first_name|first|upper }}{{ user.last_name|first|upper }}
                  </div>
                  {% endif %}
                  
                  <h4 class="text-xl font-bold text-gray-800 mb-1">{{ user.get_full_name|default:user.username }}</h4>
                  <p class="text-gray-600 mb-4">{{ user.email }}</p>
                  
                  <div class="grid grid-cols-1 gap-2">
                      <a href="{% url 'dashboard' %}" class="py-2 px-4 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-lg transition-colors">Dashboard</a>
                      <a href="{% url 'my_courses' %}" class="py-2 px-4 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-lg transition-colors">My Courses</a>
                  </div>
              </div>
          </div>
          
          <div class="mt-6 bg-white rounded-xl shadow-md overflow-hidden" data-aos="fade-right" data-aos-delay="100">
              <div class="divide-y divide-gray-200">
                  <a href="{% url 'profile' %}" class="block px-6 py-4 text-gray-700 hover:bg-gray-50 transition-colors">
                      <div class="flex items-center">
                          <i class="fas fa-user mr-3 text-primary"></i>
                          <span>Profile Information</span>
                      </div>
                  </a>
                  <a href="{% url 'password_change' %}" class="block px-6 py-4 bg-primary text-white hover:bg-primary-dark transition-colors">
                      <div class="flex items-center">
                          <i class="fas fa-lock mr-3"></i>
                          <span>Change Password</span>
                      </div>
                  </a>
                  <a href="#" class="block px-6 py-4 text-gray-700 hover:bg-gray-50 transition-colors">
                      <div class="flex items-center">
                          <i class="fas fa-bell mr-3 text-primary"></i>
                          <span>Notification Settings</span>
                      </div>
                  </a>
                  <a href="#" class="block px-6 py-4 text-gray-700 hover:bg-gray-50 transition-colors">
                      <div class="flex items-center">
                          <i class="fas fa-credit-card mr-3 text-primary"></i>
                          <span>Payment Methods</span>
                      </div>
                  </a>
                  <a href="{% url 'logout' %}" class="block px-6 py-4 text-red-600 hover:bg-red-50 transition-colors">
                      <div class="flex items-center">
                          <i class="fas fa-sign-out-alt mr-3"></i>
                          <span>Logout</span>
                      </div>
                  </a>
              </div>
          </div>
      </div>
      
      <!-- Formulário de alteração de senha -->
      <div class="w-full lg:w-3/4">
          <div class="bg-white rounded-xl shadow-md overflow-hidden" data-aos="fade-left">
              <div class="border-b border-gray-200 px-6 py-4">
                  <h4 class="text-xl font-bold text-gray-800">Change Password</h4>
              </div>
              <div class="p-6">
                  {% if messages %}
                  <div class="mb-6">
                      {% for message in messages %}
                      <div class="{% if message.tags == 'success' %}bg-green-50 border-l-4 border-green-500{% elif message.tags == 'error' %}bg-red-50 border-l-4 border-red-500{% elif message.tags == 'warning' %}bg-yellow-50 border-l-4 border-yellow-500{% else %}bg-blue-50 border-l-4 border-blue-500{% endif %} p-4 mb-4 rounded-lg">
                          <div class="flex">
                              <div class="flex-shrink-0">
                                  {% if message.tags == 'success' %}
                                  <i class="fas fa-check-circle text-green-500"></i>
                                  {% elif message.tags == 'error' %}
                                  <i class="fas fa-exclamation-circle text-red-500"></i>
                                  {% elif message.tags == 'warning' %}
                                  <i class="fas fa-exclamation-triangle text-yellow-500"></i>
                                  {% else %}
                                  <i class="fas fa-info-circle text-blue-500"></i>
                                  {% endif %}
                              </div>
                              <div class="ml-3">
                                  <p class="text-sm {% if message.tags == 'success' %}text-green-700{% elif message.tags == 'error' %}text-red-700{% elif message.tags == 'warning' %}text-yellow-700{% else %}text-blue-700{% endif %}">
                                      {{ message }}
                                  </p>
                              </div>
                          </div>
                      </div>
                      {% endfor %}
                  </div>
                  {% endif %}
                  
                  <form method="post" novalidate>
                      {% csrf_token %}
                      
                      <div class="space-y-6">
                          <!-- Old Password field -->
                          <div>
                              <label for="{{ form.old_password.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Current Password</label>
                              <input type="password" name="old_password" id="{{ form.old_password.id_for_label }}" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary transition-colors" required>
                              {% if form.old_password.errors %}
                              <p class="mt-1 text-sm text-red-600">
                                  {% for error in form.old_password.errors %}
                                  {{ error }}
                                  {% endfor %}
                              </p>
                              {% endif %}
                          </div>
                          
                          <!-- New Password field -->
                          <div>
                              <label for="{{ form.new_password1.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">New Password</label>
                              <input type="password" name="new_password1" id="{{ form.new_password1.id_for_label }}" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary transition-colors" required>
                              {% if form.new_password1.errors %}
                              <p class="mt-1 text-sm text-red-600">
                                  {% for error in form.new_password1.errors %}
                                  {{ error }}
                                  {% endfor %}
                              </p>
                              {% endif %}
                              
                          </div>
                          
                          <!-- Confirm New Password field -->
                          <div>
                              <label for="{{ form.new_password2.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">Confirm New Password</label>
                              <input type="password" name="new_password2" id="{{ form.new_password2.id_for_label }}" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary transition-colors" required>
                              {% if form.new_password2.errors %}
                              <p class="mt-1 text-sm text-red-600">
                                  {% for error in form.new_password2.errors %}
                                  {{ error }}
                                  {% endfor %}
                              </p>
                              {% endif %}
                          </div>
                      </div>
                      
                      <!-- Submit button -->
                      <div class="mt-8 flex justify-end">
                          <button type="submit" class="py-2 px-6 bg-primary hover:bg-primary-dark text-white font-semibold rounded-lg shadow hover:shadow-lg transition-all transform hover:-translate-y-0.5">
                              Change Password
                          </button>
                      </div>
                  </form>
              </div>
          </div>
      </div>
  </div>
</div>
{% endblock %}

