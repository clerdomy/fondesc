{% extends 'base.html' %}
{% load static %}

{% block title %}Kou Mwen Yo | Fondesc {% endblock %}

{% block content %}
<div class="bg-gray-50 min-h-screen py-12">
    <div class="container mx-auto px-4">
        <!-- Cabeçalho da página -->
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8" data-aos="fade-up">
            <div class="mb-4 md:mb-0">
                <h1 class="text-3xl font-bold text-gray-800">Kou Mwen Yo</h1>
                <p class="text-gray-600 mt-1">Jere epi kontinye aprantisaj ou</p>
            </div>
            <a href="{% url 'course_list' %}" class="btn-gradient bg-gradient-to-r from-primary to-primary-light text-white font-semibold px-6 py-3 rounded-lg shadow-md hover:shadow-lg transition-all transform hover:-translate-y-0.5">
                <i class="fas fa-plus mr-2"></i>Eksplore Nouvo Kou
            </a>
        </div>

        <!-- Tabs para filtrar cursos -->
        <div class="bg-white rounded-xl shadow-md overflow-hidden mb-8" data-aos="fade-up" data-aos-delay="100">
            <div class="border-b border-gray-200">
                <nav class="flex overflow-x-auto" aria-label="Tabs">
                    <button class="tab-button text-gray-600 py-4 px-6 block hover:text-primary border-b-2 border-transparent font-medium whitespace-nowrap active" id="all-tab" data-tab="all-courses">
                        <i class="fas fa-th-large mr-2"></i>Tout Kou Yo
                    </button>
                    <button class="tab-button text-gray-600 py-4 px-6 block hover:text-primary border-b-2 border-transparent font-medium whitespace-nowrap" id="in-progress-tab" data-tab="in-progress">
                        <i class="fas fa-spinner mr-2"></i>An Pwogrè
                    </button>
                    <button class="tab-button text-gray-600 py-4 px-6 block hover:text-primary border-b-2 border-transparent font-medium whitespace-nowrap" id="completed-tab" data-tab="completed">
                        <i class="fas fa-check-circle mr-2"></i>Konplete
                    </button>
                </nav>
            </div>
        </div>

        <div class="tab-content" id="all-courses">
            {% if courses_with_progress %}
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {% for course_data in courses_with_progress %}
                <div class="bg-white rounded-xl shadow-md overflow-hidden transition-all duration-300 hover:shadow-lg transform hover:-translate-y-1" data-aos="fade-up" data-aos-delay="{{ forloop.counter|add:'100' }}">
                    <!-- Imagem do curso com overlay de progresso -->
                    <div class="relative">
                        <img src="{{ course_data.enrollment.course.thumbnail.url }}" class="w-full h-48 object-cover" alt="{{ course_data.enrollment.course.title }}">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent flex items-end">
                            <div class="p-4 w-full">
                                <div class="flex justify-between items-center text-white mb-1">
                                    <span class="font-medium">Pwogrè</span>
                                    <span class="font-bold">{{ course_data.progress }}%</span>
                                </div>
                                <div class="w-full bg-gray-300 bg-opacity-40 rounded-full h-2">
                                    <div class="h-2 rounded-full {% if course_data.progress == 100 %}bg-green-500{% else %}bg-primary{% endif %}" style="width: {{ course_data.progress }}%"></div>
                                </div>
                            </div>
                        </div>
                        <!-- Badge de nível -->
                        <div class="absolute top-4 left-4">
                            <span class="px-3 py-1 bg-primary text-white text-xs font-semibold rounded-full shadow-md">
                                {{ course_data.enrollment.course.get_level_display }}
                            </span>
                        </div>
                        <!-- Badge de conclusão (se aplicável) -->
                        {% if course_data.progress == 100 %}
                        <div class="absolute top-4 right-4">
                            <span class="px-3 py-1 bg-green-500 text-white text-xs font-semibold rounded-full shadow-md flex items-center">
                                <i class="fas fa-check-circle mr-1"></i> Konplete
                            </span>
                        </div>
                        {% endif %}
                    </div>
                    
                    <div class="p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-2 line-clamp-2">{{ course_data.enrollment.course.title }}</h3>
                        <p class="text-gray-600 text-sm mb-4 line-clamp-2">{{ course_data.enrollment.course.short_description }}</p>
                        
                        <div class="flex items-center text-sm text-gray-500 mb-4">
                            <div class="flex items-center mr-4">
                                <i class="far fa-clock mr-1 text-primary"></i>
                                <span>{{ course_data.enrollment.course.duration_in_weeks }} semèn</span>
                            </div>
                            {% if course_data.last_accessed %}
                            <div class="flex items-center">
                                <i class="far fa-calendar-alt mr-1 text-primary"></i>
                                <span>{{ course_data.last_accessed|date:"d M, Y" }}</span>
                            </div>
                            {% endif %}
                        </div>
                        
                        <a href="{% url 'course_learn' slug=course_data.enrollment.course.slug %}" class="block w-full text-center py-3 px-4 bg-primary hover:bg-primary-dark text-white font-semibold rounded-lg transition-colors">
                            {% if course_data.progress == 0 %}
                            <i class="fas fa-play mr-2"></i>Kòmanse Kou
                            {% elif course_data.progress == 100 %}
                            <i class="fas fa-redo mr-2"></i>Revize Kou
                            {% else %}
                            <i class="fas fa-book-reader mr-2"></i>Kontinye Aprann
                            {% endif %}
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="bg-white rounded-xl shadow-md overflow-hidden" data-aos="fade-up">
                <div class="p-8 text-center">
                    <div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-book text-gray-400 text-4xl"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">Ou poko enskri nan okenn kou</h3>
                    <p class="text-gray-600 mb-6 max-w-md mx-auto">Eksplore katalòg kou nou yo pou jwenn kou ki pafè pou ou epi kòmanse vwayaj aprantisaj ou.</p>
                    <a href="{% url 'course_list' %}" class="inline-block py-3 px-6 bg-primary hover:bg-primary-dark text-white font-semibold rounded-lg transition-colors">
                        <i class="fas fa-search mr-2"></i>Eksplore Kou Yo
                    </a>
                </div>
            </div>
            {% endif %}
        </div>
        
        <div class="tab-content hidden" id="in-progress">
            {% if courses_with_progress %}
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {% for course_data in courses_with_progress %}
                {% if course_data.progress > 0 and course_data.progress < 100 %}
                <div class="bg-white rounded-xl shadow-md overflow-hidden transition-all duration-300 hover:shadow-lg transform hover:-translate-y-1" data-aos="fade-up" data-aos-delay="{{ forloop.counter|add:'100' }}">
                    <!-- Imagem do curso com overlay de progresso -->
                    <div class="relative">
                        <img src="{{ course_data.enrollment.course.thumbnail.url }}" class="w-full h-48 object-cover" alt="{{ course_data.enrollment.course.title }}">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent flex items-end">
                            <div class="p-4 w-full">
                                <div class="flex justify-between items-center text-white mb-1">
                                    <span class="font-medium">Pwogrè</span>
                                    <span class="font-bold">{{ course_data.progress }}%</span>
                                </div>
                                <div class="w-full bg-gray-300 bg-opacity-40 rounded-full h-2">
                                    <div class="h-2 rounded-full bg-primary" style="width: {{ course_data.progress }}%"></div>
                                </div>
                            </div>
                        </div>
                        <!-- Badge de nível -->
                        <div class="absolute top-4 left-4">
                            <span class="px-3 py-1 bg-primary text-white text-xs font-semibold rounded-full shadow-md">
                                {{ course_data.enrollment.course.get_level_display }}
                            </span>
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-2 line-clamp-2">{{ course_data.enrollment.course.title }}</h3>
                        <p class="text-gray-600 text-sm mb-4 line-clamp-2">{{ course_data.enrollment.course.short_description }}</p>
                        
                        <div class="flex items-center text-sm text-gray-500 mb-4">
                            <div class="flex items-center mr-4">
                                <i class="far fa-clock mr-1 text-primary"></i>
                                <span>{{ course_data.enrollment.course.duration_in_weeks }} semèn</span>
                            </div>
                            {% if course_data.last_accessed %}
                            <div class="flex items-center">
                                <i class="far fa-calendar-alt mr-1 text-primary"></i>
                                <span>{{ course_data.last_accessed|date:"d M, Y" }}</span>
                            </div>
                            {% endif %}
                        </div>
                        
                        <a href="{% url 'course_learn' slug=course_data.enrollment.course.slug %}" class="block w-full text-center py-3 px-4 bg-primary hover:bg-primary-dark text-white font-semibold rounded-lg transition-colors">
                            <i class="fas fa-book-reader mr-2"></i>Kontinye Aprann
                        </a>
                    </div>
                </div>
                {% endif %}
                {% endfor %}
            </div>
            
            {% if not in_progress_exists %}
            <div class="bg-white rounded-xl shadow-md overflow-hidden" data-aos="fade-up">
                <div class="p-8 text-center">
                    <div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-tasks text-gray-400 text-4xl"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">Pa gen kou an pwogrè</h3>
                    <p class="text-gray-600 mb-6 max-w-md mx-auto">Ou pa gen okenn kou ou te kòmanse men ou poko fini.</p>
                    <div class="flex flex-col sm:flex-row justify-center gap-3">
                        <a href="{% url 'course_list' %}" class="py-3 px-6 bg-primary hover:bg-primary-dark text-white font-semibold rounded-lg transition-colors">
                            <i class="fas fa-search mr-2"></i>Eksplore Kou Yo
                        </a>
                        <button class="py-3 px-6 bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 font-semibold rounded-lg transition-colors" data-tab="all-courses">
                            <i class="fas fa-th-large mr-2"></i>Wè Tout Kou Yo
                        </button>
                    </div>
                </div>
            </div>
            {% endif %}
            {% else %}
            <div class="bg-white rounded-xl shadow-md overflow-hidden" data-aos="fade-up">
                <div class="p-8 text-center">
                    <div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-tasks text-gray-400 text-4xl"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">Pa gen kou an pwogrè</h3>
                    <p class="text-gray-600 mb-6 max-w-md mx-auto">Ou pa gen okenn kou ou te kòmanse men ou poko fini.</p>
                    <div class="flex flex-col sm:flex-row justify-center gap-3">
                        <a href="{% url 'course_list' %}" class="py-3 px-6 bg-primary hover:bg-primary-dark text-white font-semibold rounded-lg transition-colors">
                            <i class="fas fa-search mr-2"></i>Eksplore Kou Yo
                        </a>
                        <button class="py-3 px-6 bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 font-semibold rounded-lg transition-colors" data-tab="all-courses">
                            <i class="fas fa-th-large mr-2"></i>Wè Tout Kou Yo
                        </button>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
        
        <div class="tab-content hidden" id="completed">
            {% if courses_with_progress %}
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {% for course_data in courses_with_progress %}
                {% if course_data.progress == 100 %}
                <div class="bg-white rounded-xl shadow-md overflow-hidden transition-all duration-300 hover:shadow-lg transform hover:-translate-y-1" data-aos="fade-up" data-aos-delay="{{ forloop.counter|add:'100' }}">
                    <!-- Imagem do curso com overlay de conclusão -->
                    <div class="relative">
                        <img src="{{ course_data.enrollment.course.thumbnail.url }}" class="w-full h-48 object-cover" alt="{{ course_data.enrollment.course.title }}">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent flex items-end">
                            <div class="p-4 w-full">
                                <div class="flex justify-between items-center text-white mb-1">
                                    <span class="font-medium">Konplete</span>
                                    <span class="font-bold">100%</span>
                                </div>
                                <div class="w-full bg-gray-300 bg-opacity-40 rounded-full h-2">
                                    <div class="h-2 rounded-full bg-green-500" style="width: 100%"></div>
                                </div>
                            </div>
                        </div>
                        <!-- Badge de nível -->
                        <div class="absolute top-4 left-4">
                            <span class="px-3 py-1 bg-primary text-white text-xs font-semibold rounded-full shadow-md">
                                {{ course_data.enrollment.course.get_level_display }}
                            </span>
                        </div>
                        <!-- Badge de conclusão -->
                        <div class="absolute top-4 right-4">
                            <span class="px-3 py-1 bg-green-500 text-white text-xs font-semibold rounded-full shadow-md flex items-center">
                                <i class="fas fa-check-circle mr-1"></i> Konplete
                            </span>
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-2 line-clamp-2">{{ course_data.enrollment.course.title }}</h3>
                        <p class="text-gray-600 text-sm mb-4 line-clamp-2">{{ course_data.enrollment.course.short_description }}</p>
                        
                        <div class="flex items-center text-sm text-gray-500 mb-4">
                            <div class="flex items-center mr-4">
                                <i class="far fa-clock mr-1 text-primary"></i>
                                <span>{{ course_data.enrollment.course.duration_in_weeks }} semèn</span>
                            </div>
                            {% if course_data.last_accessed %}
                            <div class="flex items-center">
                                <i class="fas fa-trophy mr-1 text-green-500"></i>
                                <span>Konplete nan {{ course_data.last_accessed|date:"d M, Y" }}</span>
                            </div>
                            {% endif %}
                        </div>
                        
                        <div class="flex flex-col sm:flex-row gap-2">
                            <a href="{% url 'course_learn' slug=course_data.enrollment.course.slug %}" class="flex-1 text-center py-3 px-4 bg-primary hover:bg-primary-dark text-white font-semibold rounded-lg transition-colors">
                                <i class="fas fa-redo mr-2"></i>Revize
                            </a>
                            <a href="{% url 'certificate_view' course_data.enrollment.course.slug %}" class="flex-1 text-center py-3 px-4 bg-green-500 hover:bg-green-600 text-white font-semibold rounded-lg transition-colors">
                                <i class="fas fa-certificate mr-2"></i>Sètifika
                            </a>
                        </div>
                    </div>
                </div>
                {% endif %}
                {% endfor %}
            </div>
            
            {% if not completed_exists %}
            <div class="bg-white rounded-xl shadow-md overflow-hidden" data-aos="fade-up">
                <div class="p-8 text-center">
                    <div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-trophy text-gray-400 text-4xl"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">Pa gen kou konplete ankò</h3>
                    <p class="text-gray-600 mb-6 max-w-md mx-auto">Kontinye aprann pou fini kou ou yo epi genyen sètifika!</p>
                    <div class="flex flex-col sm:flex-row justify-center gap-3">
                        <a href="{% url 'course_list' %}" class="py-3 px-6 bg-primary hover:bg-primary-dark text-white font-semibold rounded-lg transition-colors">
                            <i class="fas fa-search mr-2"></i>Eksplore Kou Yo
                        </a>
                        <button class="py-3 px-6 bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 font-semibold rounded-lg transition-colors" data-tab="in-progress">
                            <i class="fas fa-spinner mr-2"></i>Wè An Pwogrè
                        </button>
                    </div>
                </div>
            </div>
            {% endif %}
            {% else %}
            <div class="bg-white rounded-xl shadow-md overflow-hidden" data-aos="fade-up">
                <div class="p-8 text-center">
                    <div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-trophy text-gray-400 text-4xl"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">Pa gen kou konplete ankò</h3>
                    <p class="text-gray-600 mb-6 max-w-md mx-auto">Kontinye aprann pou fini kou ou yo epi genyen sètifika!</p>
                    <div class="flex flex-col sm:flex-row justify-center gap-3">
                        <a href="{% url 'course_list' %}" class="py-3 px-6 bg-primary hover:bg-primary-dark text-white font-semibold rounded-lg transition-colors">
                            <i class="fas fa-search mr-2"></i>Eksplore Kou Yo
                        </a>
                        <button class="py-3 px-6 bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 font-semibold rounded-lg transition-colors" data-tab="in-progress">
                            <i class="fas fa-spinner mr-2"></i>Wè An Pwogrè
                        </button>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Gerenciamento de abas
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        
        // Função para ativar uma aba
        function activateTab(tabId) {
            // Desativar todas as abas
            tabButtons.forEach(button => {
                button.classList.remove('active', 'text-primary', 'border-primary');
                button.classList.add('text-gray-600', 'border-transparent');
            });
            
            tabContents.forEach(content => {
                content.classList.add('hidden');
            });
            
            // Ativar a aba selecionada
            const selectedButton = document.querySelector(`[data-tab="${tabId}"]`);
            if (selectedButton) {
                selectedButton.classList.add('active', 'text-primary', 'border-primary');
                selectedButton.classList.remove('text-gray-600', 'border-transparent');
            }
            
            const selectedContent = document.getElementById(tabId);
            if (selectedContent) {
                selectedContent.classList.remove('hidden');
            }
            
            // Atualizar a URL com o hash
            window.location.hash = tabId;
        }
        
        // Adicionar event listeners aos botões de aba
        tabButtons.forEach(button => {
            button.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                activateTab(tabId);
            });
        });
        
        // Adicionar event listeners aos botões dentro do conteúdo
        document.querySelectorAll('[data-tab]').forEach(element => {
            element.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                activateTab(tabId);
                
                // Rolar para o topo se for um botão dentro do conteúdo
                if (!this.classList.contains('tab-button')) {
                    window.scrollTo({top: 0, behavior: 'smooth'});
                }
            });
        });
        
        // Verificar se há um hash na URL
        const hash = window.location.hash.substring(1) || 'all-courses';
        activateTab(hash);
        
        // Adicionar animações AOS
        if (typeof AOS !== 'undefined') {
            AOS.init({
                duration: 800,
                once: true
            });
        }
    });
</script>
{% endblock %}
{% endblock %}